{
  "name": "Workshop-popgenome",
  "tagline": "Tutorial about R package PopGenome",
  "body": "Introduction\r\n============\r\n\r\nPopGenome is an R package\r\n(<https://cran.r-project.org/web/packages/PopGenome/index.html>) for\r\nanalyses of population genomic data \\citep{Pfeifer2014}. For this\r\ntutorial, please make sure that your R working directory is set\r\ncorrectly and you have all the packages installed, e.g.\r\ninstall.packages(\"PopGenome\"). The following files are necessary to\r\nconduct this practical session:\r\n\r\n-   fasta\\_file.txt, fasta files for one locus from different\r\n    *Arabidopsis thaliana* individuals (accessions) and the outgroup\r\n    sequence from *Arabidopsis lyrata* in the folder **fasta**\r\n\r\n-   LGE22.gff, LGE22.vcf, LGE22.fa in subfolders in the folder\r\n    **great\\_tit**\r\n\r\n-   variants.vcf, ind\\_species1.txt, ind\\_species2.txt, rad\\_assembly.fa\r\n    in the folder **rad**\r\n\r\nTo get an overview about the file contents, inspect files with a text\r\nEditor (e.g. Notepad+) or via the command line (e.g. more) before\r\nstarting to work on them.\r\n\r\nLoad library into R\r\n===================\r\n\r\n\\# Loading module library(PopGenome)\r\n\r\nFasta Files\r\n===========\r\n\r\nReading Fasta Files\r\n-------------------\r\n\r\n\\# Reading data, read fasta from folder GENOME.class \\<-\r\nreadData(\"fasta\") get.sum.data(GENOME.class)\r\n\r\nWhat statistics can one obtain from get.sum.data function?\r\n\r\nFolders **fasta\\_a**, **fasta\\_b**, **fasta\\_c** contain modified\r\nalignments. Identify the differences between the datasets. Why PopGenome\r\nfails to load fasta files?\r\n\r\nObtaining summary statistics from alignments\r\n--------------------------------------------\r\n\r\n**Note:** Since calculation of certain population genetic parameter can\r\nbe computational intense, they have to be executed separately\r\nbeforehand. For this modules have to be run. Note that module **Fst**\r\nhas to be executed with **F\\_st**. The statistic Tajima’s D is part of\r\nthe module **neutrality** not **Fst**\r\n\r\n\\# Available statistics and examples show.slots(GENOME.class) \\# Run\r\nnecessary module GENOME.class \\<- F~S~T.stats(GENOME.class) GENOME.class\r\n\\<- neutrality.stats(GENOME.class) GENOME.class@n.sites GENOME.class@Pi\r\nGENOME.class@TajimaD\r\n\r\nWhat different modules are available? (show.slots)\r\n\r\nWhat module is necessary to be executed in order to obtain Wall.B\r\n\\citep{Wall1999}?\r\n\r\nHow could one obtain a per site estimate of Pi?\r\n\r\nObtaining statistics for regions\r\n--------------------------------\r\n\r\n\\# Available region data and statistics GENOME.class@region.data\r\nGENOME.class@region.stats \\# Examples\r\nGENOME.class@region.data@biallelic.sites[[1]][1:10]\r\nGENOME.class@region.data@transitions[[1]][1:10]\r\n\r\nHow many sites have gaps?\r\n\r\nHow many singletons are in the dataset?\r\n\r\nWhat is the difference between *region.data* and *region.stats*?\\\r\n(see also **Whole\\_genome\\_analyses\\_using\\_VCF\\_files.pdf**)\r\n\r\nDefine outgroups and populations\r\n--------------------------------\r\n\r\n**Note:** If one ore more outgroup sequences are defined, PopGenome will\r\nonly consider SNPs where the outgroup is monomorphic; the monomorphic\r\nnucleotide is then automatically defined as the major allele (encoded by\r\n0).\r\n\r\nget.individuals(GENOME.class) GENOME.class \\<-\r\nset.populations(GENOME.class,list(\r\nc(\"CON\",\"KAS-1\",\"RUB-1\",\"PER-1\",\"RI-0\",\"MR-0\",\"TUL-0\"),\r\nc(\"MH-0\",\"YO-0\",\"ITA-0\",\"CVI-0\",\"COL-2\",\"LA-0\",\"NC-1\") )) \\# Check\r\nwhether grouping is set correctly GENOME.class@region.data@populations\r\nGENOME.class@region.data@populations2 GENOME.class@region.data@outgroup\r\n\\# Recalculate statistics for populations GENOME.class \\<-\r\nneutrality.stats(GENOME.class) GENOME.class@Tajima.D\r\n\r\nName three implemented statistics that require an outgroup.\r\n\r\nWhat do you have to pay attention to when applying the McDonald-Kreitman\r\ntest?\\\r\n(see **Whole\\_genome\\_analyses\\_using\\_VCF\\_files.pdf**)\r\n\r\nIncluding features from GFF files to Fasta files\r\n------------------------------------------------\r\n\r\n-   If no gff-file was specified when the data was read in, it is\r\n    assumed that the alignment is in the correct reading frame (starting\r\n    at a first codon position)\r\n\r\n-   The GFF folder contains GFF-files for each alignment stored in the\r\n    FASTA folder. The GFF files should have the same names (without any\r\n    extensions like .fas or .gff) as the corresponding FASTA files to\r\n    ensure that sequence and annotation are matched correctly.\r\n\r\nAnalysing VCF files for whole genome data\r\n=========================================\r\n\r\nLoading VCF files\r\n-----------------\r\n\r\nThere are two ways to read in VCF files:\r\n\r\n-   Folder of VCF files: **readData**\r\n\r\n-   Single VCF file: **readVCF**\r\n\r\nTo read a VCF file using *readVCF* it needs to be compressed with\r\n*bgzip* and indexed with *tabix*. The tabix files need to be placed in\r\nthe same folder as the vcf file.\r\n\r\n\\# What parameters need to be defined GENOME.class\\<-\r\nreadVCF(\"great~t~it/vcf/LGE22.vcf.gz\",\r\n6000,\"chrLGE22~P~arus~M~ajor~b~uild~1~.0.2\",1,773534)\r\nGENOME.class@region.names GENOME.class\\<- neutrality.stats(GENOME.class,\r\nFAST=TRUE) get.sum.data(GENOME.class) GENOME.class@region.data\r\n\r\nWhat parameters need to be defined to *readVCF*? (see **PopGenome.pdf**)\r\n\r\nWhat is the overall diversity (theta and pi) of chromosome LGE22?\r\n\r\nLoading VCF files with annotation\r\n---------------------------------\r\n\r\nGENOME2.class \\<- readData(\"great~t~it/vcf2\",format=\"VCF\",\r\ngffpath=\"great~t~it/gff\") get.sum.data(GENOME2.class)\r\nGENOME2.class@region.data \\#get.codons(GENOME.class,1) \\#split \\<-\r\nsplitting.data(GENOME2.class, subsites=\"CDS\") GENOME2.class \\<-\r\nset.synnonsyn(GENOME2.class, ref.chr=\"great~t~it/fasta/LGE22.fasta\")\r\nGENOME2.class@region.data@synonymous\r\nGENOME2.class@region.data@CodingSNPS\r\n\r\nWhat are the advantages and disadvantages of *readData* and *readVCF*?\\\r\n(see **Whole\\_genome\\_analyses\\_using\\_VCF\\_files.pdf**)\r\n\r\nWhat is the overall diversity (theta and pi) of chromosome LGE22 for\r\nsynonymous and nonsynonymous sites?\r\n\r\nAnalysing RADseq data using VCF \r\n================================\r\n\r\n\\# SPLIT VCF FILE\r\nVCF~s~plit~i~nto~s~caffolds(\"rad/variants.vcf\",\"rad~s~plit~v~cf\") \\#\r\nREAD IN DATA GENOME.class \\<- readData(\"rad~s~plit~v~cf\",format=\"VCF\")\r\npop1 \\<-as.character(read.table(\"rad/ind~s~pecies1.txt\")[[1]]) pop2\r\n\\<-as.character(read.table(\"rad/ind~s~pecies2.txt\")[[1]]) GENOME.class\r\n\\<- set.populations(GENOME.class,list(pop1,pop2),diploid=TRUE) \\# CHECK\r\nGENOME.class@populations\r\n\r\nObtaining statistics from multiple VCFs derived from RADseq\r\n-----------------------------------------------------------\r\n\r\n\\# NEUTRALITY STATISTICS GENOME.class \\<- neutrality.stats(GENOME.class,\r\nFAST=TRUE) get.neutrality(GENOME.class)[[1]] GENOME.class@Tajima.D \\#\r\nFST GENOME.class \\<- F~S~T.stats(GENOME.class)\r\nget.F~S~T(GENOME.class)[[1]] GENOME.class@nucleotide.F~S~T \\# DIVERSITY\r\nGENOME.class \\<- diversity.stats(GENOME.class)\r\nget.diversity(GENOME.class) GENOME.class@nuc.diversity.within \\# SFS\r\nGENOME.class \\<-\r\ndetail.stats(GENOME.class,site.spectrum=TRUE,site.FST=TRUE) results \\<-\r\nget.detail(GENOME.class) GENOME.class@region.stats@minor.allele.freqs\r\n\r\nPlot a site-frequency-spectrum for each population.\r\n\r\nresults \\<- get.detail(GENOME.class) allele~F~reqs \\<-\r\nGENOME.class@region.stats@minor.allele.freqs[[1]]\r\n\r\nfreq.table \\<- list() freq.table[[1]] \\<- table(allele~F~reqs) sfs \\<-\r\ndata.frame(freq.table)\r\n\r\nlibrary(ggplot2) ggplot(sfs, aes(x=allele~F~reqs, y=Freq)) +\r\ngeom~b~ar(stat = ’identity’)\r\n\r\nMore information\r\n================\r\n\r\nMore information are available in three pdfs accompanied by the program\r\n(see folder **pdf**):\r\n\r\n1.  **An introduction to the PopGenome package**: Sliding window\r\n    analysis, reading SNP data files, coalescent simulations\r\n\r\n2.  **Whole genome analyses using PopGenome and VCF files**: Details\r\n    about reading tabixed VCF files, examples, graphical output,\r\n    parallel read-in, pre-filtering VCF files, WhopGenome\r\n    \\citep{Wittelsbuerger2015}\r\n\r\n3.  **Package PopGenome**: Documentation about all implemented functions\r\n    with examples\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}